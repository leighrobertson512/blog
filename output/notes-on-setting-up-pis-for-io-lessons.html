<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Just dropping in some code for instructors, students, and everyone [updated August 2015]. Initial Config For classes and camps, we always start with an SD card that has raspian (the Operating ...">
        <meta name="keywords" content="adafruit, python, raspberry pi">
        <link rel="icon" href="http://blog.techemstudios.com/favicon.ico">

        <title>Notes on setting up pis for I/O lessons - The Art of Technology... Training</title>

        <!-- Stylesheets -->
        <link href="http://blog.techemstudios.com/theme/css/bootstrap.min.css" rel="stylesheet">
        <link href="http://blog.techemstudios.com/theme/css/fonts.css" rel="stylesheet">
        <link href="http://blog.techemstudios.com/theme/css/nest.css" rel="stylesheet">
        <link href="http://blog.techemstudios.com/theme/css/pygment.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('http://blog.techemstudios.com/images/raspberry-pi-stock.jpg'); background-position: center; background-size: cover;">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="http://blog.techemstudios.com/"><img class="mr20" src="http://blog.techemstudios.com/images/small-icon.png" alt="logo">The Art of Technology... Training</a>
                    </div>
                    <div class="nav pull-right">
                                <a href="http://techemstudios.com">Tech Em</a>
                                <a href="http://techemstudios.com/about-us">About</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Notes on setting up pis for I/O lessons</h1>
                      <p class="header-date"> <a href="http://blog.techemstudios.com/author/wray-mills.html">Wray Mills</a>, 2015-08-21,  <a href="http://blog.techemstudios.com/category/notes.html">Notes</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="http://blog.techemstudios.com/tag/adafruit.html">adafruit</a>, <a href="http://blog.techemstudios.com/tag/python.html">python</a>, <a href="http://blog.techemstudios.com/tag/raspberry-pi.html">raspberry pi</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>Just dropping in some code for instructors, students, and everyone
[updated August 2015].</p>
<h3>Initial Config</h3>
<p>For classes and camps, we always start with an SD card that has
raspian (the Operating System) pre-installed. Of course, for the last
camp, we started with blank SD cards! So, on that first day, we were
actually loading the OS on your cards.</p>
<p>After logging in, we then ran</p>
<div class="highlight"><pre><span></span>sudo raspi-config
</pre></div>


<p>in order to extend the filesystem, set the correct time, and set the
correct keyboard.</p>
<p>We also configured your wi-fi adapter by running the gui</p>
<div class="highlight"><pre><span></span>startx
</pre></div>


<p>and using the wifi settings to scan for networks, choose the network,
type in the password, and connect. Remember, you'll have to do this
for your home wireless netework. Try to run startx without sudo. If
the GUI doesn't come up, you may have to use sudo. When you are using
the LEDS or the temp sensor, you will have to run python as sudo.</p>
<h3>Config for LEDs, Minecraft and Temp sensor</h3>
<p>In lieu of burning a pre-configured SD, we can run this script on a
raspbian pi (model 2 with pre-loaded raspian from Adafruit) in order to get python development tools, the
RPi GPIO library and the DHT library from Adafruit. Note, that this setup
assumes your pi has network (Internet) connectivity. You can type in
these commands separately, starting with the first line not containing
a #.</p>
<div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="c1"># Run this command using sudo</span>

<span class="c1"># Beforehand, you should expand filesystem, turn on ssh</span>
<span class="c1"># and of course configure network.</span>

<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">dev</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span>
<span class="n">sudo</span> <span class="n">easy_install</span> <span class="o">-</span><span class="n">U</span> <span class="n">distribute</span>
<span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">RPi</span><span class="o">.</span><span class="n">GPIO</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">adafruit</span><span class="o">/</span><span class="n">Adafruit_Python_DHT</span>
<span class="n">cd</span> <span class="n">Adafruit_Python_DHT</span>
<span class="n">sudo</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
<span class="n">cd</span> <span class="o">..</span>
</pre></div>


<h3>LEDs</h3>
<p>So, for the Output portion of the I/O lesson (easier than input so you
may as well start here), assume a green LED is wired to #20 and a red
LED is wired to #21.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">RPi.GPIO</span> <span class="kn">as</span> <span class="nn">GPIO</span>

<span class="n">DEBUG</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">GPIO</span><span class="o">.</span><span class="n">setmode</span><span class="p">(</span><span class="n">GPIO</span><span class="o">.</span><span class="n">BCM</span><span class="p">)</span>
<span class="n">GREEN_LED</span> <span class="o">=</span> <span class="mi">20</span> 
<span class="n">RED_LED</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">GREEN_LED</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
<span class="n">GPIO</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">RED_LED</span><span class="p">,</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">green_led</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">GREEN_LED</span><span class="p">,</span><span class="n">state</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">red_led</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">RED_LED</span><span class="p">,</span><span class="n">state</span><span class="p">)</span>
</pre></div>


<p>So, a simple session to use these methods would look like this:</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python</span>
<span class="o">&gt;&gt;&gt;</span><span class="kn">from</span> <span class="nn">led</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">green_led</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">red_led</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">green_led</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">red_led</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="n">quit</span><span class="p">()</span>
</pre></div>


<h3>Extend the LED Morse Code output</h3>
<p>We started a program that reads input from a user and converts that
input into LED morse code. Start with this snippet and see if you can
finish it -- let us know how you do!!</p>
<div class="highlight"><pre><span></span><span class="c1"># Remember, everything after a # is a comment</span>
<span class="c1"># Comments are here for humans to explain code to</span>
<span class="c1"># other humans. Anything after a # is ignored by</span>
<span class="c1"># the computer</span>

<span class="c1"># Use the imports you have for the leds</span>
<span class="c1"># For example: from led import *</span>


<span class="k">def</span> <span class="nf">dash</span><span class="p">():</span>
    <span class="c1">#whatever code you already have here</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">),</span>

<span class="k">def</span> <span class="nf">dot</span><span class="p">():</span>
    <span class="c1"># whatever code you already have here</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">),</span>

<span class="k">def</span> <span class="nf">morse_a</span><span class="p">():</span>
    <span class="n">dot</span><span class="p">()</span>
    <span class="n">dash</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">morse_b</span><span class="p">():</span>
    <span class="n">dash</span><span class="p">()</span>
    <span class="n">dot</span><span class="p">()</span>
    <span class="n">dot</span><span class="p">()</span>
    <span class="n">dot</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">morse_c</span><span class="p">():</span>
    <span class="n">dash</span><span class="p">()</span>
    <span class="n">dot</span><span class="p">()</span>
    <span class="n">dash</span><span class="p">()</span>
    <span class="n">dot</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">morse_d</span><span class="p">():</span>
    <span class="n">dash</span><span class="p">()</span>
    <span class="n">dot</span><span class="p">()</span>
    <span class="n">dot</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">morse_e</span><span class="p">():</span>
    <span class="n">dot</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">morse_t</span><span class="p">():</span>
    <span class="n">dash</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">morse</span><span class="p">(</span><span class="n">character</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">character</span> <span class="o">!=</span> <span class="s2">&quot; &quot;</span><span class="p">:</span>
            <span class="nb">globals</span><span class="p">()[</span><span class="s2">&quot;morse_&quot;</span><span class="o">+</span><span class="n">character</span><span class="o">.</span><span class="n">lower</span><span class="p">()]()</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">character</span> <span class="o">+</span> <span class="s2">&quot; not defined in morse yet.&quot;</span><span class="p">),</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Type in text to convert to morse code.&quot;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="n">morse</span><span class="p">(</span><span class="n">character</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</pre></div>


<p>If you save this file as "morse_output.py" for example, you may run it
with:</p>
<div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python</span> <span class="n">morse_output</span><span class="o">.</span><span class="n">py</span>
</pre></div>


<h3>Input Sensor (Temp/Humidity Sensor including in your Tech Em kit)</h3>
<p>For the Input part of the lesson, here is some code that provides a single simple method to
return temperature and humidity (from a DHT-22 temperature/humidity
sensor <a href="https://learn.adafruit.com/dht-humidity-sensing-on-raspberry-pi-with-gdocs-logging/wiring">wired to pin #4</a>).</p>
<div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Template code for temperature and humidity from an Adafruit DHT22</span>
<span class="c1"># sensor. Don&#39;t forget to update this file if you connect the DHT22 </span>
<span class="c1"># to another data pin,</span>
<span class="c1"># want to change the delay, or logic for mailing. </span>
<span class="c1"># For example, you may only want to</span>
<span class="c1"># send notifications when certain thresholds are exceeded.</span>
<span class="c1"># </span>
<span class="c1"># Code provided for Tech Em students and open under Gnu GPL</span>
<span class="c1">#</span>
<span class="c1"># Wray Mills</span>
<span class="c1"># 20141115</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">Adafruit_DHT</span>
<span class="c1"># Tech Em mail utility</span>
<span class="c1"># from mailit import *</span>

<span class="n">sensor</span> <span class="o">=</span> <span class="n">Adafruit_DHT</span><span class="o">.</span><span class="n">DHT22</span>
<span class="n">pin</span> <span class="o">=</span> <span class="mi">4</span> 

<span class="k">def</span> <span class="nf">read_temp_humidity</span><span class="p">():</span>
    <span class="n">humidity</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="n">Adafruit_DHT</span><span class="o">.</span><span class="n">read_retry</span><span class="p">(</span><span class="n">sensor</span><span class="p">,</span> <span class="n">pin</span><span class="p">)</span>
    <span class="n">temp_f</span> <span class="o">=</span> <span class="n">temperature</span> <span class="o">*</span> <span class="mf">9.0</span> <span class="o">/</span> <span class="mf">5.0</span> <span class="o">+</span> <span class="mf">32.0</span>
    <span class="k">return</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">temp_f</span><span class="p">,</span> <span class="n">humidity</span>
</pre></div>


<p>Launch python with sudo, import this file and call the method to get
the tuple of celsius temperature, fahrenheit temperature, and relative humidity.</p>
<p><img alt="Rpi prototype board with DHT22 on one side and two LEDs on the other" src="http://blog.techemstudios.com/images/rpi-io.jpg" /></p>


        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title"></div>
                        <ul class="list-unstyled">
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title"></div>
                        <ul class="list-unstyled">
                            <li><a href="http://twitter.com/techemrva" target="_blank">@TechEmRVA</a></li>
                            <li><a href="http://facebook.com/techemstudios" target="_blank">TechEm Studios on FB</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title"></div>
                        <ul class="list-unstyled">
                            <li><a href="http://techemstudios.com" target="_blank">Tech Em Studios</a></li>
                            <li><a href="http://python.org/" target="_blank">Python.org</a></li>
                            <li><a href="http://getpelican.com" target="_blank">Pelican</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small></small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>